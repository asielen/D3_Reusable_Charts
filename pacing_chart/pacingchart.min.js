function makePacingChart(t){let e={};function s(t,s){return function(){e.objs.tooltip.transition().duration(200),e.objs.tooltip.html(e.tooltipGenerator(t,s))}}function a(t){return t?((t=t.replace(/[^a-z0-9-]/g,(function(t){var e=t.charCodeAt(0);return 32==e||95==e?"-":e>=65&&e<=90?t.toLowerCase():"_"}))).match(/^[0-9]/g)&&(t="_"+t),t):""}return e.settings={data:null,selector:null,targetsCols:[],targetsMarkersCols:[],resultsCols:[],resultMarkersCols:[],titleCols:[],chartWidth:500,barHeight:35,titlePadding:100,lowerSummaryPadding:20,minWidthForPercent:100,cumulativeTargets:!0,cumulativeResults:!0,summarizeTargets:!1,summarizeResults:!1,w_threshold:25,p_threshold:.1,_constrainToTarget:!1},e.groupObjs={},e.objs={mainDiv:null,chartDiv:null,g:null},e.set=t=>{let s=!1;for(let a in t)e.settings[a]=t[a],"data"===a&&(e.data=e.settings.data,s=!0),["formatterValue","formatterValueToolTip","formatterPercent","tooltipGenerator"].includes(a)&&"function"==typeof a&&(e[a]=a);return e.width=e.settings.chartWidth,e.height=e.settings.barHeight*(2+e.settings.summarizeTargets+e.settings.summarizeResults)+e.settings.lowerSummaryPadding,e.barWidth=e.settings.chartWidth-e.settings.titlePadding,e.barHeight=e.settings.barHeight,s&&function(){function t(t){return Math.round(10*Math.ceil(t/10))}let s=(t,e)=>t.value<e.value?-1:t.value>e.value?1:0,a=(t,a,r)=>{let l=[];for(const n of t){let t=n,i=n;"string"!=typeof n&&(t=n[0],i=n[1]),l.push({column:t,name:i,value:e.data[a][t]}),r||l.sort(s)}return l};function r(s,r){let l={title:"",subtitle:null,index:0,classes:[],unique_id:"",svg:{parent:null,title:null,subtitle:null,targets:null,results:null,targetsMarkers:null,resultsMarkers:null},metrics:{targets:[],results:[],targetsMarkers:[],resultsMarkers:[]}};return l.index=r,l.unique_id="g"+r+"-"+Math.random().toString(16).slice(2),s.unique_id=l.unique_id,"string"!=typeof e.settings.titleCols?(l.title=s[e.settings.titleCols[0]],l.subtitle=s[e.settings.titleCols[1]]):l.title=s[e.settings.titleCols],l.metrics.targets=a(e.settings.targetsCols,r,e.settings.cumulativeTargets),l.metrics.targetsMarkers=a(e.settings.targetsMarkersCols,r,e.settings.cumulativeTargets),l.metrics.results=a(e.settings.resultsCols,r,e.settings.cumulativeResults),l.metrics.resultsMarkers=a(e.settings.resultMarkersCols,r,e.settings.cumulativeResults),l.metrics.resultsLastIndex=l.metrics.results.length-1,l.metrics.targetsMax=e.settings.cumulativeTargets?Math.max(...l.metrics.targets.map((t=>t.value))):l.metrics.targets.map((t=>+t.value)).reduce(((t,e)=>t+e)),l.metrics.targetsMarkersMax=Math.max(...l.metrics.targetsMarkers.map((t=>t.value))),l.metrics.resultsMax=e.settings.cumulativeResults?Math.max(...l.metrics.results.map((t=>t.value))):l.metrics.results.map((t=>+t.value)).reduce(((t,e)=>t+e)),l.metrics.resultsMin=Math.min(...l.metrics.results.map((t=>t.value))),l.metrics.resultsMarkersMax=Math.max(...l.metrics.resultsMarkers.map((t=>t.value))),l.metrics.resultsMarkersMin=Math.min(...l.metrics.resultsMarkers.map((t=>t.value))),l.metrics.metricsMax=Math.max(l.metrics.targetsMax,l.metrics.resultsMax,l.metrics.targetsMarkersMax,l.metrics.resultsMarkersMax),l.metrics.results.forEach((t=>{t.percent_to_target=t.value/l.metrics.targetsMax})),l.metrics.resultsMarkers.forEach((t=>{t.percent_to_target=t.value/l.metrics.targetsMax})),l.classes.push("p"+t(l.metrics.resultsMax/l.metrics.targetsMax*100).toString()),l}let l=null;for(let t=0;t<e.data.length;t++)l=r(e.data[t],t),e.groupObjs[l.unique_id]=l}(),e},e.formatterValue=t=>{let e=Math.ceil(Math.log10(t+1))%3;return 0===e?d3.format(".3s")(t):d3.format("."+(e+1)+"s")(t)},e.formatterValueToolTip=t=>{let e=Math.ceil(Math.log10(t+1))%3;return 0===e?d3.format(".5s")(t):d3.format("."+(e+2)+"s")(t)},e.formatterPercent=t=>100*t%1!=0?d3.format(",.2%")(t):d3.format(",.0%")(t),e.tooltipGenerator=function(t,s){let a='<span class="chart title">'+t.title;t.subtitle&&(a+=" "+t.subtitle);let r="";a+="</span><hr>Targets:";let l=0,n="";for(const a of t.metrics.targets)s.name===a.name&&(r="selected"),e.settings.cumulativeTargets?a.value>l&&(l=a.value):l+=a.value,n+="<span class='"+r+"'><span class='target title'>"+a.name+"</span> : <span class='target value '>"+e.formatterValueToolTip(a.value)+"</span></span><br >",r="";t.metrics.targets.length>1?a+=" "+e.formatterValueToolTip(l)+"<br >":a+="<br >",a+=n;for(const l of t.metrics.targetsMarkers)s.name===l.name&&(r="selected"),a+="<span class='"+r+"'><span class='target-metrics title '>> "+l.name+"</span> : <span class='target-metrics value '>"+e.formatterValueToolTip(l.value)+"</span></span><br >",r="";a+="<hr>Results:";let i=0,u="";for(const a of t.metrics.results)s.name===a.name&&(r="selected"),e.settings.cumulativeResults?a.value>i&&(i=+a.value):i+=+a.value,u+="<span class='"+r+"'><span class='result title '>"+a.name+"</span> : <span class='result value '>"+e.formatterValueToolTip(a.value)+" | "+e.formatterPercent(a.percent_to_target)+"</span></span><br >",r="";t.metrics.results.length>1?a+=" "+e.formatterValueToolTip(i)+"<br >":a+="<br >",a+=u;for(const l of t.metrics.resultsMarkers)s.name===l.name&&(r="selected"),a+="<span class='"+r+"'><span class='result-marketer title '>> "+l.name+"</span> : <span class='result-marker value '>"+e.formatterValueToolTip(l.value)+" | "+e.formatterPercent(l.percent_to_target)+"</span></span><br >",r="";return a},e.update=function(){function t(t){let s={xScale:null,widthCalc:null,calcTargetWidth:null,calcResultWidth:null};var r,l;e.settings._constrainToTarget?s.xScale=d3.scaleLinear().domain([0,t.targetsMax]).range([0,e.barWidth]):s.xScale=d3.scaleLinear().domain([0,t.metricsMax]).range([0,e.barWidth]),s.calcWidth=(r=s.xScale,l=r(0),t=>Math.abs(r(t)-l));const n=(t,e,a)=>(r,l)=>l>0&&l<=e.length-1&&a?Math.abs(t(r.value)-t(e[l-1].value)):s.calcWidth(r.value);s.calcTargetWidth=n(s.xScale,t.targets,e.settings.cumulativeTargets),s.calcResultWidth=n(s.xScale,t.results,e.settings.cumulativeResults),s.calcTargetMarkerX=t=>s.calcWidth(t.value)+e.settings.titlePadding,s.calcResultMarkerX=t=>s.calcWidth(t.value)+e.settings.titlePadding;const i=(t,s)=>function(a,r){let l=e.settings.titlePadding;return r>0&&r<=s.length-1?l+t(s[r-1].value):l},u=(t,s)=>function(a,r){let l=e.settings.titlePadding;if(r>0&&r<=s.length-1){for(let e=r-1;e>=0;e--)l+=t(s[e].value);return l}return l};return s.calcTargetX=e.settings.cumulativeTargets?i(s.xScale,t.targets):u(s.xScale,t.targets),s.calcResultX=e.settings.cumulativeResults?i(s.xScale,t.results):u(s.xScale,t.results),s.targetBarFormat=(t,r)=>{let l="target s"+r,n=s.calcTargetWidth(t,r);for(let t=0;t<=Math.round(n);t+=e.settings.w_threshold)l+=` w${t}`;return l+=" "+a(t.column),t.column!==t.name&&(l+=" "+a(t.name)),t.classes&&t.classes.length&&(l+=t.classes.join(" ")),l},s.targetTextLabel=(t,s)=>e.formatterValue(t.value),s.targetTextFormat=(t,e)=>{let s="target text s"+e;return s+=" "+a(t.column),t.column!==t.name&&(s+=" "+a(t.name)),s},s.targetsYPos=(t,s)=>{let a=0;return e.settings.summarizeTargets&&(a+=e.barHeight),a},s.resultBarFormat=(r,l)=>{let n="result s"+l,i=s.calcResultWidth(r,l);for(let t=0;t<=Math.round(i);t+=e.settings.w_threshold)n+=` w${t}`;for(let t=0;t<=r.percent_to_target;t+=e.settings.p_threshold)n+=` p${Math.round(100*t)}`;return l===t.resultsLastIndex&&(n+=" last"),n+=" "+a(r.column),r.column!==r.name&&(n+=" "+a(r.name)),r.classes&&r.classes.length&&(n+=r.classes.join(" ")),n},s.resultTextLabel=(t,a)=>{let r=e.formatterValue(t.value);return s.calcResultWidth(t,a)>=e.settings.minWidthForPercent&&(r+=" ("+e.formatterPercent(t.percent_to_target)+")"),r},s.resultsYPos=(t,s)=>{let a=e.barHeight;return e.settings.summarizeTargets&&(a+=e.barHeight),e.settings.summarizeResults&&(a+=e.barHeight),a},s.resultTextFormat=(t,e)=>{let s="result text s"+e;return s+=" "+a(t.column),t.column!==t.name&&(s+=" "+a(t.name)),s},s.targetMarkerFormat=(t,e)=>{let s="marker s"+e;return t.classes&&t.classes.length&&(s+=t.classes.join(" ")),s+=" "+a(t.column),t.column!==t.name&&(s+=" "+a(t.name)),s},s.resultMarkerFormat=(t,s)=>{let r="marker s"+s;for(let s=0;s<=t.percent_to_target;s+=e.settings.p_threshold)r+=` p${Math.round(100*s)}`;return t.classes&&t.classes.length&&(r+=t.classes.join(" ")),r+=" "+a(t.column),t.column!==t.name&&(r+=" "+a(t.name)),r},s}function s(t){t.svg.targets=t.g.append("g").attr("class","targets");let s=t.svg.targets.selectAll("svg").data(t.metrics.targets).enter().append("svg").attr("class",t.methods.targetBarFormat).attr("width",t.methods.calcTargetWidth).attr("height",e.barHeight).attr("y",t.methods.targetsYPos).attr("x",t.methods.calcTargetX);s.append("rect").attr("class",t.methods.targetBarFormat).attr("width","100%").attr("height","100%"),s.append("text").attr("class",t.methods.targetTextFormat).attr("dy",".1em").attr("y","50%").attr("x","50%").attr("dominant-baseline","middle").style("text-anchor","middle").text((function(e,s){return t.methods.targetTextLabel(e)}));let a=t.svg.targets.node().getBBox().width+e.settings.titlePadding;t.svg.results=t.g.append("g").attr("class","results");let r=t.svg.results.selectAll("svg").data(t.metrics.results).enter().append("svg").attr("class",t.methods.resultBarFormat).attr("width",t.methods.calcResultWidth).attr("height",e.barHeight).attr("x",t.methods.calcResultX).attr("y",t.methods.resultsYPos);r.append("rect").attr("class",t.methods.resultBarFormat).attr("width","100%").attr("height","100%"),r.append("text").attr("class",t.methods.resultTextFormat).attr("dy",".1em").attr("y","50%").attr("x","50%").attr("dominant-baseline","middle").attr("text-anchor","middle").text((function(e,s){return t.methods.resultTextLabel(e,s)}));let l=t.svg.results.node().getBBox().width+e.settings.titlePadding;l>e.barWidth-75?t.svg.results.append("text").attr("class","summary").attr("dy",".1em").attr("y",(function(s,a){return t.methods.resultsYPos(s,a)+e.barHeight+4})).attr("x",l).attr("dominant-baseline","hanging").attr("text-anchor","end").text(e.formatterValue(t.metrics.resultsMax)+" ("+e.formatterPercent(t.metrics.resultsMax/t.metrics.targetsMax)+")"):t.svg.results.append("text").attr("class","summary").attr("dy",".1em").attr("y",(function(s,a){return t.methods.resultsYPos(s,a)+e.barHeight/2})).attr("x",l+5).attr("dominant-baseline","middle").attr("text-anchor","start").text(e.formatterValue(t.metrics.resultsMax)+" ("+e.formatterPercent(t.metrics.resultsMax/t.metrics.targetsMax)+")"),t.svg.targetsMarkers=t.g.append("g").attr("class","targets-markers");t.svg.targetsMarkers.selectAll("svg").data(t.metrics.targetsMarkers).enter().append("line").attr("class",t.methods.targetMarkerFormat).attr("x1",t.methods.calcTargetMarkerX).attr("x2",t.methods.calcTargetMarkerX).attr("y1",t.methods.targetsYPos).attr("y2",(function(s,a){return t.methods.targetsYPos(s,a)+e.barHeight}));t.svg.resultsMarkers=t.g.append("g").attr("class","results-markers");t.svg.resultsMarkers.selectAll("svg").data(t.metrics.resultsMarkers).enter().append("line").attr("class",t.methods.resultMarkerFormat).attr("x1",t.methods.calcResultMarkerX).attr("x2",t.methods.calcResultMarkerX).attr("y1",t.methods.resultsYPos).attr("y2",(function(s,a){return t.methods.resultsYPos(s,a)+e.barHeight}));if(e.settings.summarizeTargets){t.svg.targetsSummary=t.g.append("g").attr("class","targets-summary");let s=t.svg.targetsSummary.append("svg").attr("class","summary").attr("width",a-e.settings.titlePadding).attr("height",e.barHeight).attr("x",e.settings.titlePadding).attr("y","0");s.append("rect").attr("class","summary").attr("width","100%").attr("height","100%"),a-e.settings.titlePadding<=e.settings.minWidthForPercent?t.svg.resultsSummary.append("text").attr("class","summary").attr("dy",".1em").attr("y",.5*e.barHeight).attr("x",a+5).attr("dominant-baseline","middle").attr("text-anchor","start").text(e.formatterValue(t.metrics.targetsMax)):s.append("text").attr("dy",".1em").attr("y","50%").attr("x","50%").attr("dominant-baseline","middle").attr("text-anchor","middle").text(e.formatterValue(t.metrics.targetsMax))}if(e.settings.summarizeResults){t.svg.resultsSummary=t.g.append("g").attr("class","results-summary");let s=t.svg.resultsSummary.append("svg").attr("class","summary").attr("width",l-e.settings.titlePadding).attr("height",e.barHeight).attr("x",e.settings.titlePadding).attr("y",(function(s,a){return t.methods.targetsYPos(1,1)+e.barHeight}));s.append("rect").attr("class","summary").attr("width","100%").attr("height","100%"),l-e.settings.titlePadding<=e.settings.minWidthForPercent?t.svg.resultsSummary.append("text").attr("class","summary").attr("dy",".1em").attr("y",(function(s,a){return t.methods.targetsYPos(1,1)+1.5*e.barHeight})).attr("x",l+5).attr("dominant-baseline","middle").attr("text-anchor","start").text(e.formatterValue(t.metrics.resultsMax)+" ("+e.formatterPercent(t.metrics.resultsMax/t.metrics.targetsMax)+")"):s.append("text").attr("dy",".1em").attr("y","50%").attr("x","50%").attr("dominant-baseline","middle").attr("text-anchor","middle").text(e.formatterValue(t.metrics.resultsMax)+" ("+e.formatterPercent(t.metrics.resultsMax/t.metrics.targetsMax)+")")}return t}for(const a in e.groupObjs)e.groupObjs[a].methods=t(e.groupObjs[a].metrics),s(e.groupObjs[a])},e.set(t),e.render=function(){return e.objs.mainDiv=d3.select(e.settings.selector),e.objs.mainDiv.node().classList.add("pace-chart"),e.objs.mainDiv.append("div").attr("class","inner-box").style("display","flex").style("flex-wrap","wrap"),e.selector=e.settings.selector+" .inner-box",e.objs.chartDiv=d3.select(e.selector),e.objs.g=e.objs.chartDiv.selectAll("div.chart-area").data(e.data).enter().append("div").attr("class","group chart-area").append("svg").attr("width",e.width).attr("height",e.height),e.objs.titles=e.objs.g.append("g").style("text-anchor","end"),e.objs.titles.append("text").attr("class","title").attr("x","95").attr("y",e.barHeight*(2+e.settings.summarizeTargets+e.settings.summarizeResults)/2).text((function(t){return t[e.settings.titleCols[0]]})),e.objs.titles.append("text").attr("class","subtitle").attr("dy","1em").attr("x","95").attr("y",e.barHeight*(2+e.settings.summarizeTargets+e.settings.summarizeResults)/2).text((function(t){return t[e.settings.titleCols[1]]})),e.objs.tooltip=e.objs.mainDiv.append("div").attr("class","tooltip"),e.objs.g.each((function(t,r){for(let r in e.groupObjs)r===t.unique_id&&(e.groupObjs[r].g=d3.select(this),e.groupObjs[r].g.attr("class",a(e.groupObjs[r].title)+" "+a(e.groupObjs[r].subtitle)),e.groupObjs[r].g.attr("id",e.groupObjs[r].unique_id),e.groupObjs[r].g.on("mouseover",(function(t,s){e.objs.tooltip.style("display",null).style("left",t.pageX+"px").style("top",t.pageY-28+"px")})).on("mouseout",(function(){e.objs.tooltip.style("display","none")})).on("mousemove",(function(t,a){e.objs.tooltip.style("left",t.pageX+10+"px").style("top",t.pageY-10+"px"),s(e.groupObjs[r],t.target.__data__)()})))})),e.update(),e},e}
